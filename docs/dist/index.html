<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>ECMPS Beta API Examples</title>
    <link rel="stylesheet" type="text/css" href="./assets/css/styles.css">
    <style>
        .note-style {
          font-size: 0.8em;
          color: #666;
        }
        .code-style {
          padding: 0.5em; 
          border: 1px solid #71767a; 
          background: #dfe1e2;
          text-wrap: wrap;
        }
        .response-style {
          display: block; 
          overflow-x: auto; 
          padding: 0.5em; 
          background: rgb(51, 51, 51); 
          color: white; 
          margin: 0;
        }
        ol li {
            font-weight: bold;
            font-size: 1.17em;
        }
        ol li span {
            font-weight: normal;
            font-size: 1rem;
        }
      </style>
  </head>
  <body>
    <main>
      <div class="margin-5">
        <h1>Clean Air Markets ECMPS Beta API Examples</h1>
        <p>Below are some examples of how the ECMPS Beta API endpoints could be used to find useful information you may be looking for.
            For the examples below, you only need an API key. If you do not have an API key, you can <a href="https://www.epa.gov/power-sector/cam-api-portal#/api-key-signup">request one here</a>.
            However, there are endpoints that require a token as well. Generally the endpoints that require a token 
            have the word "workspace" in the endpoint name.
        </p>

        <p>On this page:</p>
        <ul>
            <li><a href="#simple-configuration">Simple Configuration</a></li>
            <li><a href="#complex-configuration">Complex Configuration</a></li>
        </ul>

        <div class="border bg-base-lightest padding-x-2 margin-y-2">
            <h2 id="simple-configuration">Simple Configuration</h2>
            
            <ol>
                <li>
                    <span><h3>Use an Oris Code (Facility Id) to get a monitoring plan configuration</h4>
                    <p>The best place to start for most people is with the <b>configurations endpoint</b> in the <a target="_blank" href="https://www.epa.gov/power-sector/cam-api-portal#/swagger/beta-monitor-plan-mgmt">Monitoring Plan API</a>.
                    <p>Below is a javascript example script making a call to the configurations endpoint using oris code 3 (Barry).</p>
                    <pre class="code-style">
    <code>const response = await fetch('https://api.epa.gov/easey/beta/monitor-plan-mgmt/configurations?orisCodes=3',
    {
        headers: {
            "x-api-key": "YOUR_API_KEY_HERE"
        },
        referrerPolicy: "no-referrer",
        "method": "GET",
    });
    const data = await response.json();</code></pre>
            
                    <button class="usa-button" id = "monPlanConfigButton">Run script</button>
                
                    <div class="maxh-mobile margin-top-1 border-1px" style="overflow:auto;">
                        <pre id="monitoring-plan-config-response" class="response-style">
                        ...
                        </pre>
                    </div></span>
                </li>
                <li>
                    <span><h3>Use a monitoring plan id</h4>
                    <p>The first "Id" of each object in the response above is the unique identifier (Id) of a monitoring configuration record. You will see this as parameters 
                        to use in other endpoints (named: monitorPlanId, monPlanIds or planIds). For example, lets take the fifth monitoring plan id in the response above and use it.</p>
                    <span class="note-style">Note: We use the fifth monitoring plan because this is a simple stack configuration.</span>
                    <pre class="code-style"><code>const monPlanId = <span id="monitoring-plan-id"></span></code></pre>
                    
                    <p>Below is a javascript example script collecting data from the emissions export endpoint from the <a target="_blank" href="https://www.epa.gov/power-sector/cam-api-portal#/swagger/beta-emissions-mgmt">Emissions API</a>.</p>
                    
                    <pre class="code-style">
    <code>const response = await fetch('<span id="emissions-export-url"></span>',
    {
        headers: {
            "x-api-key": "YOUR_API_KEY_HERE"
        },
        referrerPolicy: "no-referrer",
        "method": "GET",
        });
    const data = await response.json();</code></pre>
                
                    <button class="usa-button" id = "emissionsExportButton">Run script</button>
                    
                    <div class="maxh-mobile margin-top-1 border-1px" style="overflow:auto;">
                        <pre id="emissions-export-response" class="response-style">
                        ...
                        </pre>
                    </div></span>
                </li>
                <li>
                    <span><h3>Use a location id</h4>
                    <p>In the first response above, the "Id" under the location objects are the unique identifier (Id) of a monitoring location record. You will see this as parameters 
                        to use in other endpoints (named: locId). For example, lets take the the same fifth monitoring plan and use the location id.</p>
                    <span class="note-style">Note: There is only one location Id in this example, but that may not always be the case.</span>
                    <pre class="code-style"><code>const locId = <span id="location-id"></span></code></pre>
                    
                    <p>Below is a javascript example script collecting data from the location attributes endpoint from the <a target="_blank" href="https://www.epa.gov/power-sector/cam-api-portal#/swagger/beta-monitor-plan-mgmt">Monitoring Plan API</a>.</p>
                    <pre class="code-style">
    <code>const response = await fetch('<span id="location-attributes-url"></span>',
    {
        headers: {
            "x-api-key": "YOUR_API_KEY_HERE"
        },
        referrerPolicy: "no-referrer",
        "method": "GET",
        });
    const data = await response.json();</code></pre>
                
                    <button class="usa-button" id = "locationAttributeButton">Run script</button>
                    
                    <div class="maxh-mobile margin-top-1 border-1px" style="overflow:auto;">
                        <pre id="location-attributes-response" class="response-style">
                        ...
                        </pre>
                    </div></span>
                </li>
            </ol>
        </div>

        <div><div class="border bg-base-lightest padding-x-2 margin-y-2">
            <h2 id="complex-configuration" class="font-sans-xl">Complex Configuration</h2>
        </div>
        
        </div>
    </main>
    <script src="main.js"></script>
  </body>
</html>
